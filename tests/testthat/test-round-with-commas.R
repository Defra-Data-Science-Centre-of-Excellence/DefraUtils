test_that("expected output is returned", {
  expect_type(round_with_commas(1.1, "round_to", round_to = 1), "character")
  expect_s3_class(round_with_commas(c(1.1, 1.3), "round_to", round_to = 1), NA)
})

test_that("comma is added", {
  expect_equal(round_with_commas(1500, "round_to", round_to = 100), "1,500")
})

test_that("round_to argument works", {
  expect_equal(round_with_commas(1.14, "round_to", round_to = 0.1), "1.1")
  expect_equal(round_with_commas(1.15, "round_to", round_to = 0.1), "1.2")
  expect_equal(round_with_commas(1.4, "round_to", round_to = 1), "1")
  expect_equal(round_with_commas(1.5, "round_to", round_to = 1), "2")
  expect_equal(round_with_commas(14, "round_to", round_to = 10), "10")
  expect_equal(round_with_commas(15, "round_to", round_to = 10), "20")
  expect_equal(round_with_commas(140, "round_to", round_to = 100), "100")
  expect_equal(round_with_commas(150, "round_to", round_to = 100), "200")
})

test_that("optimise argument works", {
  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "1"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "1"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "1"), "114")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "100"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "100"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "100"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "100"), "1,100")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "1k"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "1k"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "1k"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "1k"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "1k"), "11,000")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "10k"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "10k"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "10k"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "10k"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "10k"), "10,000")
  expect_equal(round_with_commas(111114, "optimise", optimise_to = "10k"), "110,000")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "100k"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "100k"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "100k"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "100k"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "100k"), "10,000")
  expect_equal(round_with_commas(111114, "optimise", optimise_to = "100k"), "100,000")
  expect_equal(round_with_commas(1111114, "optimise", optimise_to = "100k"), "1,100,000")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "1m"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "1m"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "1m"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "1m"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "1m"), "10,000")
  expect_equal(round_with_commas(111114, "optimise", optimise_to = "1m"), "100,000")
  expect_equal(round_with_commas(1111114, "optimise", optimise_to = "1m"), "1,000,000")
  expect_equal(round_with_commas(11111114, "optimise", optimise_to = "1m"), "11,000,000")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "10m"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "10m"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "10m"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "10m"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "10m"), "10,000")
  expect_equal(round_with_commas(111114, "optimise", optimise_to = "10m"), "100,000")
  expect_equal(round_with_commas(1111114, "optimise", optimise_to = "10m"), "1,000,000")
  expect_equal(round_with_commas(11111114, "optimise", optimise_to = "10m"), "10,000,000")
  expect_equal(round_with_commas(111111114, "optimise", optimise_to = "10m"), "110,000,000")

  expect_equal(round_with_commas(1.14, "optimise", optimise_to = "100m"), "1.1")
  expect_equal(round_with_commas(14, "optimise", optimise_to = "100m"), "14")
  expect_equal(round_with_commas(114, "optimise", optimise_to = "100m"), "100")
  expect_equal(round_with_commas(1114, "optimise", optimise_to = "100m"), "1,000")
  expect_equal(round_with_commas(11114, "optimise", optimise_to = "100m"), "10,000")
  expect_equal(round_with_commas(111114, "optimise", optimise_to = "100m"), "100,000")
  expect_equal(round_with_commas(1111114, "optimise", optimise_to = "100m"), "1,000,000")
  expect_equal(round_with_commas(11111114, "optimise", optimise_to = "100m"), "10,000,000")
  expect_equal(round_with_commas(111111114, "optimise", optimise_to = "100m"), "100,000,000")
  expect_equal(round_with_commas(1111111114, "optimise", optimise_to = "100m"), "1,100,000,000")
})
